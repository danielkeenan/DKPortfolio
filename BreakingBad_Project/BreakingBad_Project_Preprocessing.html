---
layout: default
---

<body>
    <h1>Breaking Bad Project Part 2 - Preprocessing</h1>
    <h2>Preprocessing the scraped data</h2>
    <p>In this project, I have performed some web scraping of Breaking Bad episode transcripts and have preprocessed them for EDA.</p>
    <h3><a href="/DKPortfolio">Home</a></h3>
    <p><a href="/DKPortfolio/BreakingBad_Project/BreakingBad_Project_Web_Scraping.html">Part 1 - Web Scraping</a></p> 
    <p><a href="/DKPortfolio/BreakingBad_Project/BreakingBad_Project_EDA.html">Part 3 - EDA</a></p> 
    <p></p>

    <h3>Import statements:</h3>
    <pre><code>
        import pandas as pd
        import re
        from textblob import TextBlob
        from tqdm.notebook import tqdm
    </code></pre>

    <h3>Reading in the dataset:</h3>
    <pre><code>
        df = pd.read_csv('Breaking_Bad_s1s2.csv')
        df.head()
    </code></pre>

    <h3>Exploring the data:</h3>
    <pre><code>
        df.shape
    </code></pre>
    <img src='images/shape.png'>
    <pre><code>
        df.info()
    </code></pre>
    <img src='images/info.png'>
    <pre><code>
        df[df.duplicated()]
    </code></pre>
    <img src='images/dupe.png'>
    <pre><code>
        df.isna().sum()
    </code></pre>
    <img src='images/isna.png'>

    <h3>Removing motions from the line text:</h3>
    <pre><code>
        df[df['Line'].str.contains('\([^)]*\)')]
    </code></pre>
    <img src='images/motion1.png'>
    <pre><code>
        df['Motion'] = df['Line'].apply(lambda x: re.findall(r'\([^)]*\)', x))
        df['Line'] = df['Line'].apply(lambda x: re.sub(r'\([^)]*\)', '', x))
        df[df['Line'].str.contains('\([^)]*\)')]
    </code></pre>
    <img src='images/motion2.png'>

    <h3>Adding polarity and subjectivity to the dataset:</h3>
    <pre><code>
        tqdm.pandas()

        df['Polarity'] = df['Line'].progress_apply(lambda x: TextBlob(x).sentiment[0])
        df['Subjectivity'] = df['Line'].progress_apply(lambda x: TextBlob(x).sentiment[1])
    </code></pre>
    <img src='images/polsub.png'>
    
    <h3>Saving to a CSV file</h3>
    <pre><code>
        df.to_csv('Breaking_Bad_s1s2_preprocessed.csv', index=False)
    </code></pre>
